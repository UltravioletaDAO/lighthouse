# üöÄ Lighthouse Standalone Extraction Guide

**Date:** October 29, 2025
**Status:** Ready for Extraction ‚úÖ

---

## üìä Executive Summary

**Answer: YES, Lighthouse is 100% ready to be extracted standalone.**

### Current Status

‚úÖ **Zero hard dependencies on Karmacadabra**
‚úÖ **Self-contained architecture**
‚úÖ **Independent deployment infrastructure**
‚úÖ **Separate technology stack (Rust vs Python)**
‚úÖ **Different payment token (USDC vs GLUE)**

### Recommendation

**EXTRACT NOW** before Phase 1 development begins.

**Why:**
- Clean separation of concerns
- Independent git history
- Separate CI/CD pipelines
- Different deployment targets (AWS/EigenCloud vs Karmacadabra's ECS)
- Easier to attract external contributors
- Clearer licensing (Lighthouse = MIT, Karmacadabra = TBD)

---

## üîç Dependency Analysis

### Hard Dependencies (Code-level)

**Result: ZERO ‚ùå**

```bash
# Search for Karmacadabra imports
grep -r "from shared\." lighthouse/
grep -r "import shared" lighthouse/
grep -r "from \.\./shared" lighthouse/
grep -r "sys\.path.*karmacadabra" lighthouse/

# Result: NONE (except in facilitator-monitor.md which is archived design doc)
```

**Findings:**
- ‚úÖ No imports from `karmacadabra/shared/`
- ‚úÖ No imports from `karmacadabra/erc-8004/`
- ‚úÖ No imports from `karmacadabra/erc-20/`
- ‚úÖ No imports from `karmacadabra/x402-rs/`

---

### Soft Dependencies (Infrastructure/Conceptual)

#### 1. **x402 Facilitator (Optional)**

**Status:** Optional external service

```env
# .env.example line 43
FACILITATOR_URL=https://facilitator.ultravioletadao.xyz
```

**Analysis:**
- Lighthouse CAN use the Karmacadabra facilitator as an **external service**
- OR it can deploy its own facilitator (it's open-source)
- OR it can handle USDC transfers directly (no facilitator needed initially)

**Action:** No code changes needed. It's just a URL config.

---

#### 2. **USDC Token Addresses (Public Constants)**

```env
# .env.example lines 36-38
USDC_AVAX_FUJI=0x5425890298aed601595a70AB815c96711a31Bc65
USDC_BASE_SEPOLIA=0x036CbD53842c5426634e7929541eC2318f3dCF7e
USDC_POLYGON_MUMBAI=0x0FA8781a83E46826621b3BC094Ea2A0212e71B23
```

**Analysis:**
- These are **public USDC contract addresses** (not Karmacadabra-specific)
- Anyone can find these on Circle's documentation
- No dependency on Karmacadabra

**Action:** None. These are standard ERC-20 addresses.

---

#### 3. **AWS Secrets Manager (Pattern)**

```env
# .env.example line 74
AWS_SECRET_NAME=lighthouse-production
```

**Analysis:**
- Lighthouse uses AWS Secrets Manager **pattern** learned from Karmacadabra
- But it creates **its own secrets** (not shared with Karmacadabra)
- Secret name: `lighthouse-production` (not `karmacadabra-agents`)

**Action:** None. Separate secret store.

---

#### 4. **Domain Naming Convention**

```
lighthouse.ultravioletadao.xyz
faro.ultravioletadao.xyz
```

**Analysis:**
- Uses `ultravioletadao.xyz` parent domain
- Follows same pattern as `facilitator.karmacadabra.ultravioletadao.xyz`
- This is a **branding** decision, not a code dependency

**Action:**
- Keep domains under `ultravioletadao.xyz` (same organization)
- Or register standalone domain: `lighthouse.xyz` / `faro.xyz` (later)

---

### Documentation Dependencies

**Files that mention Karmacadabra (for context only):**

1. `lighthouse-master-plan.md` - Explains "Why Lighthouse supersedes WatchTower"
2. `README.md` - FAQ mentions it's standalone but developed within Karmacadabra repo
3. `facilitator-monitor.md` - Old WatchTower design doc (archived, can delete)

**Action:** Update docs to remove context references when extracting.

---

## ‚úÖ Extraction Checklist

### Phase 1: Create New Repository

- [ ] Create new GitHub repository: `ultravioletadao/lighthouse`
- [ ] Initialize with `.gitignore` (Rust + Python + Docker)
- [ ] Add LICENSE file (recommend MIT for wider adoption)
- [ ] Add CODE_OF_CONDUCT.md
- [ ] Add CONTRIBUTING.md

---

### Phase 2: Copy Files

```bash
# Create new repository
mkdir lighthouse-standalone
cd lighthouse-standalone
git init

# Copy all Lighthouse files
cp -r /path/to/karmacadabra/lighthouse/* .

# Files to copy:
‚úÖ lighthouse-master-plan.md
‚úÖ DEPLOYMENT-STEP-BY-STEP.md
‚úÖ README.md
‚úÖ docker-compose.yml
‚úÖ .env.example
‚úÖ .gitignore
‚úÖ backend/ (when created in Phase 1)
‚úÖ workers/ (when created in Phase 2)
‚úÖ terraform/ (all 16 files created by terraform-specialist)
‚úÖ Database analysis docs (5 files from master-architect)
‚úÖ AWS deployment docs (from terraform-specialist)

# Files to DELETE or archive:
‚ùå facilitator-monitor.md (archived WatchTower design)
‚ùå lighthouse-vs-watchtower.md (move to /docs/archive/)
‚ùå simulation-scenarios.md (WatchTower-specific, archive)
```

---

### Phase 3: Update Documentation

#### `README.md`

**Remove:**
```markdown
**Location:** `z:\ultravioleta\dao\karmacadabra\lighthouse\`
```

**Replace with:**
```markdown
**Repository:** https://github.com/ultravioletadao/lighthouse
```

**Update FAQ:**
```markdown
**Q: Is Lighthouse part of Karmacadabra?**
A: No. Lighthouse is a standalone universal monitoring platform.
It was initially designed within the Karmacadabra repository but has
been extracted to its own project. Karmacadabra will be one of many
customers using Lighthouse for monitoring.
```

---

#### `lighthouse-master-plan.md`

**Update Section 3 (Architecture Decision):**

```markdown
## üèóÔ∏è Architecture Decision

### Standalone Project ‚úÖ

**Location:**
```
https://github.com/ultravioletadao/lighthouse
```

**Previously:** Developed within `karmacadabra/lighthouse/` for context and reference

**Now:** Extracted to standalone repository for:
- ‚úÖ Independent evolution
- ‚úÖ Separate git history
- ‚úÖ Different deployment lifecycle
- ‚úÖ Easier external contributions
- ‚úÖ Clear separation of concerns

**Relationship with Karmacadabra:**
- Lighthouse monitors Karmacadabra agents (customer relationship)
- Uses x402 facilitator as external service (optional)
- Shares organizational branding (ultravioletadao.xyz domains)
- No code dependencies
```

---

### Phase 4: Infrastructure Setup

#### GitHub Repository Settings

```yaml
Repository: ultravioletadao/lighthouse
Visibility: Public
Description: "Universal trustless monitoring platform for Web3. AWS Synthetics alternative with crypto payments (USDC)."
Topics:
  - monitoring
  - web3
  - blockchain
  - rust
  - timescaledb
  - aws-synthetics
  - usdc
  - avalanche
  - devops
  - observability

Branches:
  - main (default)
  - develop
  - staging

Branch Protection (main):
  ‚úÖ Require pull request before merging
  ‚úÖ Require approvals: 1
  ‚úÖ Require status checks (CI/CD when set up)
  ‚úÖ Require conversation resolution
  ‚ùå Allow force pushes (never!)
```

---

#### Secrets Configuration (GitHub Actions)

```bash
# Repository Secrets (Settings ‚Üí Secrets ‚Üí Actions)

AWS_ACCESS_KEY_ID=AKIA...
AWS_SECRET_ACCESS_KEY=...
AWS_REGION=us-east-1

DOCKERHUB_USERNAME=ultravioletadao
DOCKERHUB_TOKEN=dckr_pat_...

LIGHTHOUSE_PRODUCTION_SECRET_ARN=arn:aws:secretsmanager:us-east-1:...

DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/...  # For deployment notifications
```

---

### Phase 5: CI/CD Pipeline

#### `.github/workflows/ci.yml`

```yaml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  test-backend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Rust
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
      - name: Run tests
        run: cd backend && cargo test
      - name: Run clippy
        run: cd backend && cargo clippy -- -D warnings

  test-terraform:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v2
      - name: Terraform Format
        run: cd terraform && terraform fmt -check -recursive
      - name: Terraform Validate
        run: |
          cd terraform/environments/prod
          terraform init -backend=false
          terraform validate

  docker-build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Build Docker images
        run: docker-compose build
      - name: Test Docker Compose
        run: |
          docker-compose up -d
          sleep 10
          curl http://localhost:8080/health || exit 1
          docker-compose down
```

---

#### `.github/workflows/deploy.yml`

```yaml
name: Deploy to Production

on:
  push:
    branches: [main]
    tags:
      - 'v*'

jobs:
  deploy-aws:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - uses: actions/checkout@v3

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-1

      - name: Deploy with Terraform
        run: |
          cd terraform/environments/prod
          terraform init
          terraform apply -auto-approve

      - name: Notify Discord
        uses: sarisia/actions-status-discord@v1
        if: always()
        with:
          webhook: ${{ secrets.DISCORD_WEBHOOK_URL }}
          title: "Lighthouse Deployment"
          description: "Deployed to production"
```

---

### Phase 6: Project Structure (Standalone)

```
lighthouse/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ ci.yml
‚îÇ       ‚îú‚îÄ‚îÄ deploy.yml
‚îÇ       ‚îî‚îÄ‚îÄ release.yml
‚îú‚îÄ‚îÄ backend/                    # Rust API server
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/             # SQL migrations
‚îÇ   ‚îú‚îÄ‚îÄ Cargo.toml
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ workers/                    # Python Celery workers
‚îÇ   ‚îú‚îÄ‚îÄ canary/
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ terraform/                  # IaC for AWS/EigenCloud
‚îÇ   ‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ timescaledb-ec2/
‚îÇ   ‚îú‚îÄ‚îÄ environments/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dev/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ staging/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prod/
‚îÇ   ‚îî‚îÄ‚îÄ DEPLOYMENT-GUIDE.md
‚îú‚îÄ‚îÄ docs/                       # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DATABASE-ARCHITECTURE-ANALYSIS.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TIMESCALEDB-IMPLEMENTATION-GUIDE.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TIMESCALEDB-AWS-DEPLOYMENT-ARCHITECTURE.md
‚îÇ   ‚îú‚îÄ‚îÄ guides/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DEPLOYMENT-STEP-BY-STEP.md
‚îÇ   ‚îî‚îÄ‚îÄ archive/
‚îÇ       ‚îú‚îÄ‚îÄ lighthouse-vs-watchtower.md
‚îÇ       ‚îî‚îÄ‚îÄ facilitator-monitor.md
‚îú‚îÄ‚îÄ frontend/                   # (Phase 5 - Landing page)
‚îÇ   ‚îî‚îÄ‚îÄ (React/Next.js)
‚îú‚îÄ‚îÄ scripts/                    # Utility scripts
‚îÇ   ‚îî‚îÄ‚îÄ cost-calculator.sh
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ lighthouse-master-plan.md   # Main design doc
‚îú‚îÄ‚îÄ LICENSE                     # MIT
‚îú‚îÄ‚îÄ CODE_OF_CONDUCT.md
‚îú‚îÄ‚îÄ CONTRIBUTING.md
‚îú‚îÄ‚îÄ CHANGELOG.md
‚îî‚îÄ‚îÄ SECURITY.md
```

---

### Phase 7: Update References

#### In Karmacadabra Repository

**Add to `karmacadabra/README.md`:**

```markdown
## üîó Related Projects

### Lighthouse (Universal Monitoring)
**Repository:** https://github.com/ultravioletadao/lighthouse

Lighthouse is a standalone monitoring platform that monitors Karmacadabra
agents (and any other Web3 service). It was developed within this repository
and has been extracted to its own project.

**Key Features:**
- AWS Synthetics alternative (50x cheaper)
- Crypto-native payments (USDC)
- Multi-chain support (Avalanche, Base, Polygon)
- TimescaleDB for time-series data

**Usage:** Karmacadabra agents use Lighthouse for health monitoring and alerting.
```

---

#### Update CLAUDE.md

**Add to `karmacadabra/CLAUDE.md`:**

```markdown
## Related Projects

### Lighthouse Monitoring
- **Location:** https://github.com/ultravioletadao/lighthouse (separate repo)
- **Purpose:** Monitors Karmacadabra agents + facilitator
- **Relationship:** Customer (not dependency)
- **Note:** Was developed in `karmacadabra/lighthouse/` but extracted Oct 2025
```

---

### Phase 8: DNS & Domains

```bash
# Current domains (keep as-is, point to new infrastructure)
lighthouse.ultravioletadao.xyz  ‚Üí AWS ECS/EC2 (Lighthouse standalone infra)
faro.ultravioletadao.xyz        ‚Üí AWS ECS/EC2 (Lighthouse standalone infra)

# AWS Route53 configuration stays the same
# Just update A records to point to Lighthouse's own load balancer/EC2
```

**No changes needed** - domains already decoupled from Karmacadabra infrastructure.

---

## üéØ Timeline

### Option A: Extract Before Phase 1 (RECOMMENDED)

```
Day 1 (2 hours):
‚îú‚îÄ Create GitHub repo
‚îú‚îÄ Copy files
‚îú‚îÄ Update docs
‚îî‚îÄ Initial commit

Day 2 (1 hour):
‚îú‚îÄ Set up CI/CD
‚îú‚îÄ Configure secrets
‚îî‚îÄ Test Docker Compose build

Day 3 onwards:
‚îî‚îÄ Start Phase 1 development in standalone repo
```

**Advantages:**
- ‚úÖ Clean git history from day 1
- ‚úÖ No migration headaches later
- ‚úÖ Easier to track Lighthouse-specific issues
- ‚úÖ Independent release cycle

---

### Option B: Extract After MVP (Week 3)

```
Week 1-2: Develop in karmacadabra/lighthouse/
Week 3: Extract to standalone repo
```

**Advantages:**
- ‚úÖ Keep context during development
- ‚úÖ Easy access to Karmacadabra patterns

**Disadvantages:**
- ‚ùå Need to migrate git history
- ‚ùå More complex extraction
- ‚ùå Risk of creating accidental dependencies

---

## ‚úÖ Recommendation

### **EXTRACT NOW (Option A)**

**Reasoning:**
1. **Zero code dependencies** - Nothing to untangle
2. **Different tech stack** - Rust vs Python, different deployment
3. **Separate market** - Web3 ecosystem vs AI agents
4. **Independent scaling** - Lighthouse may grow 10x faster
5. **Cleaner contribution model** - External devs want standalone repos

---

## üìã Pre-Extraction Checklist

Before creating standalone repo:

**Documentation:**
- [x] Master plan complete (`lighthouse-master-plan.md`)
- [x] Deployment guide complete (`DEPLOYMENT-STEP-BY-STEP.md`)
- [x] Database architecture documented (5 files)
- [x] Terraform infrastructure ready (16 files)
- [x] Docker Compose configured

**Infrastructure:**
- [x] .env.example with all variables
- [x] docker-compose.yml (TimescaleDB + Redis)
- [x] Terraform modules (timescaledb-ec2)
- [x] Cost calculator script

**Dependencies:**
- [x] Zero hard dependencies on Karmacadabra code
- [x] Can deploy independently
- [x] Uses public USDC contracts
- [x] Optional external facilitator (not required)

**Domains:**
- [x] lighthouse.ultravioletadao.xyz registered
- [x] faro.ultravioletadao.xyz registered
- [x] Can point to independent infrastructure

---

## üöÄ Extraction Command

```bash
# 1. Create new repo on GitHub
gh repo create ultravioletadao/lighthouse --public \
  --description "Universal trustless monitoring platform for Web3" \
  --clone

cd lighthouse

# 2. Copy files from Karmacadabra
cp -r /path/to/karmacadabra/lighthouse/* .

# 3. Remove Karmacadabra-specific files
rm facilitator-monitor.md
rm simulation-scenarios.md
mkdir -p docs/archive
mv lighthouse-vs-watchtower.md docs/archive/

# 4. Update README.md (remove Karmacadabra paths)
# Edit manually

# 5. Create new LICENSE (MIT recommended)
cat > LICENSE <<EOF
MIT License

Copyright (c) 2025 Ultravioleta DAO

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
EOF

# 6. Initial commit
git add .
git commit -m "Initial commit: Lighthouse standalone extraction

Extracted from karmacadabra/lighthouse/ (Oct 2025)

Lighthouse is a universal trustless monitoring platform for Web3:
- AWS Synthetics alternative (50x cheaper)
- Crypto-native payments (USDC)
- Multi-chain support (Avalanche, Base, Polygon)
- TimescaleDB for time-series data

Complete with:
- Master plan (50,000 words of architecture docs)
- Terraform infrastructure (AWS EC2 + EBS)
- Docker Compose for local dev
- Database schema (PostgreSQL + TimescaleDB)

Zero dependencies on Karmacadabra codebase.
Developed by Ultravioleta DAO.

ü§ñ Generated with Claude Code
Co-Authored-By: Claude <noreply@anthropic.com>"

# 7. Push to GitHub
git branch -M main
git push -u origin main

# 8. Create develop branch
git checkout -b develop
git push -u origin develop

# Done! ‚úÖ
```

---

## üìä Post-Extraction Metrics

After extraction, you should have:

```
Repository: ultravioletadao/lighthouse
Stars: 0 ‚Üí Target 100+ (within 6 months)
Contributors: 1 (you) ‚Üí Target 5+ (external devs)
Issues: 0
Pull Requests: 0

Files:
- 22 documentation files (~50,000 words)
- 16 Terraform files (~10,000 lines IaC)
- 1 docker-compose.yml
- 0 backend files (to be created in Phase 1)

Total Size: ~2 MB (mostly docs, no binaries)
Languages:
  - Markdown: 95% (docs)
  - HCL: 5% (Terraform)
  - Rust: 0% (Phase 1)
  - Python: 0% (Phase 2)
```

---

## ‚úÖ Final Answer

**YES - Extract Lighthouse to standalone repository NOW.**

**You have:**
- ‚úÖ Complete architecture documentation (50,000 words)
- ‚úÖ Production-ready infrastructure (Terraform + Docker)
- ‚úÖ Zero code dependencies on Karmacadabra
- ‚úÖ Clear deployment strategy (AWS/EigenCloud)
- ‚úÖ Independent technology stack (Rust vs Python)

**Next steps:**
1. Run extraction commands above (30 minutes)
2. Set up GitHub repo + CI/CD (1 hour)
3. Start Phase 1 development in standalone repo
4. Keep Karmacadabra as first customer/reference implementation

**No blockers. Ready to go!** üöÄ
